<!DOCTYPE html>
<html lang="en">

  <!-- View -->
  <headReplace metal:use-macro="/templates/header.xhtml/meta_head">
  </headReplace>

  <body>

    <navReplace metal:use-macro="./templates/nav.xhtml/nav_bar">
    </navReplace>
  
   
    <section class="divider_01" >

        <div class="row">

            <table id="products">
                <thead>
                    <tr>
                        <th style="width: 10%">SKU</th>
                        <th style="width: 50%">Product Name</th> 
                        <th style="width: 10%">Quantity</th>
                        <th style="width: 10%">Price</th>
                        <th style="width: 10%"></th>
                        <th style="width: 10%"></th>
                    </tr>
                </thead>
                <tbody id="productlist">
                
                
                </tbody>
                <!-- ADMIN DASHBOARD DROPDOWN PRODUCT MANAGER -->

            </table>


          
        </div>

    </section>

    <footerReplace metal:use-macro="./templates/footer.xhtml/footer_bar">
    </footerReplace> 
      
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="./js/main.js"></script>
      <script>
    $(document).ready(function() {
                function adminloadProducts() {
                $.ajax({
                    url: "admin_products.php",
                    type: "GET",
                    dataType: 'html',
                    success: function(returnedData) {
                        //console.log("cart checkout response: ", returnedData);
                        $("#productlist").html(returnedData);

                    },
                    error: function(jqXHR, textStatus, errorThrown) {
                        console.log(jqXHR.statusText, textStatus);
                    }
                });
            }

            adminloadProducts();
        
            //WORK IN PROGRESS
            $('#productlist').on('click', 'input[data-sku-add]', function() {
                //console.log(this.getAttribute("data-sku-add"));
/*
                // get the sku
                var sku = this.getAttribute("data-sku-add");
                var qty = $("input[data-sku-qty='" + sku + "']").val();
                var price = $("td[data-sku-price='" + sku + "']").text();
                var desc = $("td[data-sku-desc='" + sku + "']").text();
                var subtotal = parseFloat(Math.round((qty * price) * 100) / 100).toFixed(2);
                console.log(desc, "quantity", qty, "price", price);

                var shoppingCartList = $("#shoppingCart");


                // ALTERED FOR WEB STORAGE
                var aDate = new Date();
                var item = "<li data-item-sku='" + sku + "' data-item-qty='" + qty + "' data-item-date='"
                    + aDate.getTime() + "'>" + desc + " " + qty + " x $" + price + " = " + subtotal
                    + " <input type='button' data-remove-button='remove' value='X'/></li>";
                shoppingCartList.append(item);


                // SESSION STORAGE - SAVE SKU AND QTY AS AN OBJECT IN THE
                // ARRAY INSIDE OF THE AUTOSAVE OBJECT
                var cartData = sessionStorage.getObject('autosave');
                if(cartData == null) {
                    return;
                }
                var item = {'sku': sku, 'qty': qty, date: aDate.getTime(), 'desc': desc, 'price': price};
                cartData['items'].push(item);
                // clobber the old value
                sessionStorage.setObject('autosave', cartData);

*/
            });
        
    });
    </script>
  </body>
    
    
</html>
